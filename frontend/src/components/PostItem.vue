<template>
    <div class="post">
        <div v-if="postDTO.titleImg" class="img-wrapper">
            <router-link :to="{name: post, params: { id: postDTO.id} }"><img :src="postDTO.titleImg"/></router-link>
        </div>
        <div class="text-wrapper">
            <div class="post-head">
                <router-link :to="{name: post, params: { id: postDTO.id} }"><h2 v-html="postDTO.title"></h2></router-link>
                <owner v-if="postDTO.owner" prepend="written by" :owner="postDTO.owner" :time="createTime"></owner>
            </div>
            <!-- Html used for highlight search results. Html tags are generated by fulltext search engine. -->
            <div class="post-content" v-html="postDTO.text"></div>
        </div>
        <hr size="1"/>
    </div>
</template>

<script>
    import {post} from '../routes';
    import Owner from './Owner.vue'
    import {getTimestampFromUtc} from '../utils'

    export default {
        name: 'post-item',
        props: ['postDTO'], // it may be an object, for ability to set default values
        data() {
            return {
                post: post
            }
        },
        components:{
            Owner
        },
        computed:{
            createTime(){
                return getTimestampFromUtc(this.postDTO.createDateTime);
            }
        },
    }
</script>

<style lang="stylus" scoped>
    @import "../constants.styl"
    $borderColor=red;
    $imgMaxHeight=200px
    .post {
        display block
        // border-style solid
        border-width 1px;
        border-color $borderColor
        padding 2px;
        margin 2px;
        //clear: both

        .img-wrapper {
            // max-height 400px;
            // clear both
            img {
                float: left
                margin 10px;
                width: 350px;
                // display inline
                // height: auto;
                //max-height 400px;
                max-height $imgMaxHeight
            }

            img:hover {
                transform scale(1.2)
                box-shadow: 7px 7px 34px 22px rgba(0,0,0,0.6);
                transition all 0.2s
            }
        }

        .text-wrapper {
            //clear: both
            // height auto
            // float: right;
            min-height 100px
            max-height 600px;
            font-size $postBodyFontSize
            font-family $postBodyFontFamily

            .post-head{
                display flex
                flex-direction row
                //justify-content space-between
                flex-wrap wrap
            }

            a {
                text-decoration: none;
                h2 {
                    padding 2px;
                    margin 2px;
                    color $postTitleColorLink
                    font-size $postTitleFontSize
                    font-weight $postTitleFontWeight
                    font-family $postTitleFontFamily

                    u {
                        color red
                    }

                }
            }

        }

        hr {
            clear both
            color lightgrey
        }
    }

    @media screen and (max-width: $contentWidth) {
        .post {
            .img-wrapper {
                img {
                    float: none
                    margin 0px;
                    // margin 4px;
                    width auto
                    max-width 100%
                    max-height 500px
                }
                img:hover {
                    transform none
                    box-shadow: none
                    transition none
                }
            }

            .post-content {
                overflow-x auto
            }

        }
    }
</style>