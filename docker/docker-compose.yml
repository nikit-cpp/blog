version: '2'

services:
  #enviroment
   postgresql:
    image : postgres:${POSTGRESL_VERSION}
    hostname: postgresql
    # имена контейнеров не должны пересекаться с уже существующими
    container_name: postgresql-blog-dev
    restart: unless-stopped
    ports:
     - 5432
    environment:
     - POSTGRES_PASSWORD=postgresqlPassword
    volumes :
     - ./postgresql/docker-entrypoint-initdb.d:/docker-entrypoint-initdb.d
     - postgresql_blog_dev_data_dir:/var/lib/postgresql/data
    networks:
     blog-dev:
      ipv4_address: 172.22.0.2
    logging:
     driver: "json-file"
     options:
       max-size: "50m"
       max-file: "1"

   redis:
    image: redis:${REDIS_VERSION}
    hostname: redis
    container_name: redis-blog-dev
    restart: unless-stopped
    ports:
     - 6379
    volumes :
     - redis_blog_dev_data_dir:/data
    networks:
     blog-dev:
      ipv4_address: 172.22.0.3
    logging:
     driver: "json-file"
     options:
       max-size: "50m"
       max-file: "1"

volumes:
  #enviroment
  postgresql_blog_dev_data_dir:
  redis_blog_dev_data_dir:

networks:
  blog-dev:
    driver: bridge
#    driver_opts:
#      com.docker.network.enable_ipv6: "true"
#      com.docker.network.bridge.enable_ip_masquerade: "false"
    ipam:
      driver: default
      config:
      - subnet: 172.22.0.0/24
        gateway: 172.22.0.1
